function onEdit(e) {
  var sheet = e.source.getActiveSheet();
  var range = e.range;

  // Only act if editing column D (stage)
  if (range.getColumn() !== 4) return;

  var status = range.getValue();
  var row = range.getRow();
  var rowData = sheet.getRange(row, 1, 1, sheet.getLastColumn()).getValues()[0];

  // Reference target sheets
  var ss = e.source;
  var leadsSheet     = ss.getSheetByName("Leads");
  var fuSheet        = ss.getSheetByName("F/U");
  var awardedSheet   = ss.getSheetByName("Awarded");
  var purgatorySheet = ss.getSheetByName("Purgatory");

  // Move logic by sheet
  if (sheet.getName() === "Leads") {
    if (status === "Quote sent") {
      fuSheet.appendRow(rowData);
      sheet.deleteRow(row);
    } else if (status === "Archive") {
      purgatorySheet.appendRow(rowData);
      sheet.deleteRow(row);
    }
  }

  else if (sheet.getName() === "F/U") {
    if (status === "Awarded") {
      awardedSheet.appendRow(rowData);
      sheet.deleteRow(row);
    } else if (status === "Archive" || status === "LOST") {
      purgatorySheet.appendRow(rowData);
      sheet.deleteRow(row);
    }
  }
}
