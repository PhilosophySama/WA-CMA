function handleAddressChange_(sheet, row, address) {
  const S = MOVE_CONFIG;
  const addressStr = String(address || '').trim();   // <â€” this is the var
  const target = sheet.getRange(row, S.COLS.EARTH_LINK);

  if (addressStr) {
    try {
      const url = 'https://earth.google.com/web/search/' + encodeURIComponent(addressStr);
      const rich = SpreadsheetApp.newRichTextValue()
        .setText('Earth')
        .setLinkUrl(url)
        .build();
      target.setRichTextValue(rich);
    } catch (err) {
      target.setValue(`Error: ${err.message}`);
    }
  } else {
    target.clearContent();
  }
}
